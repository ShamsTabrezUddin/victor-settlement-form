<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Full & Final Settlement Agreement</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <style>
    html, body {
      font-family: Arial, Helvetica, sans-serif !important;
    }
    @media print {
      .no-print { display: none; }
      body { background: white !important; }
    }
    input:invalid {
      border-color: #f87171 !important;
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-800">
  <div class="flex flex-col items-center justify-center min-h-screen">
    <!-- Form heading -->
    <div class="w-full max-w-xl mb-2 text-center">
      <div class="text-lg font-bold mt-2 mb-6">Victor Luxury Limousine LLC</div>
    </div>
    <!-- FORM -->
    <form id="settlement-form" class="bg-white shadow p-6 mb-8 w-full max-w-xl rounded-xl space-y-4 ring-1 ring-slate-200">
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-slate-600">Employee Name</span>
          <input type="text" id="employeeName"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            required
            placeholder="e.g., Vishnu Vardhan Deshaveni" />
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">Emirates ID</span>
          <input
            type="text"
            id="emiratesId"
            minlength="18"
            maxlength="18"
            required
            pattern="\\d{3}-\\d{4}-\\d{7}-\\d"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            placeholder="784-1998-3005118-3"
            title="Format: xxx-xxxx-xxxxxxx-x (15 digits and 3 hyphens, total 18 characters)"
          />
        </label>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-slate-600">Date</span>
          <input type="text" id="date"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            required
            placeholder="dd/mm/yyyy"
            autocomplete="off" />
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">Labor Card No</span>
          <input type="text" id="laborCard"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            required
            placeholder="e.g., 127315096" />
        </label>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-slate-600">Position</span>
          <input type="text" id="position"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            required
            placeholder="e.g., Light Driver" />
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">Settlement Period</span>
          <input type="month" id="period"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            required />
        </label>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-slate-600">Offer Letter Salary (AED)</span>
          <input type="number" id="offerSalary"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            placeholder="e.g., 2000" />
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">MOHRE Contract Salary (AED)</span>
          <input type="number" id="mohreSalary"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            placeholder="e.g., 500" />
        </label>
      </div>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-slate-600">Authorized Signatory Name</span>
          <input type="text" id="signName"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            placeholder="e.g., A. Kumar" />
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">Authorized Signatory Designation</span>
          <input type="text" id="signDesg"
            class="pl-2 mt-1 w-full rounded-none border-slate-300 focus:border-slate-500 focus:ring-slate-500"
            placeholder="e.g., Manager" />
        </label>
      </div>
      <div class="flex items-center gap-3 pt-2">
        <button type="button" id="generate" class="pl-2 px-4 py-2 rounded-none bg-slate-900 text-white hover:bg-slate-800">Generate Letter</button>
        <button type="button" id="downloadPdf" class="pl-2 px-4 py-2 rounded-none bg-green-600 text-white hover:bg-green-700 ring-1 ring-green-400 hover:ring-green-600" disabled>Download PDF</button>
        <button type="reset" class="pl-2 px-4 py-2 rounded-none bg-white ring-1 ring-slate-300 hover:bg-slate-50">Reset</button>
      </div>
    </form>
    <!-- PREVIEW -->
    <div class="bg-white shadow p-10 w-full max-w-2xl rounded-xl ring-1 ring-slate-200 mb-4" id="letter">
      <div class="mt-16"></div>
      <div class="text-center mb-8">
        <div class="text-lg font-bold underline tracking-wide mb-2">Full and Final Settlement / No Dues Declaration</div>
      </div>
      <!-- Updated preview header: Date on top, Employee Name and Labor Card No side by side -->
      <div class="w-full flex justify-center mt-4">
        <table class="text-[14px] font-semibold w-auto">
          <tr>
            <td class="text-right pr-12 font-semibold" colspan="4">Date</td>
            <td class="text-left pl-0 font-semibold" colspan="4">: <span id="datePreview">—</span></td>
          </tr>
          <tr>
            <td class="pr-4 font-semibold">Employee Name</td>
            <td class="text-right pl-1 font-semibold">:</td>
            <td class="pl-2 w-[180px]" id="employeeNamePreview">—</td>
            <td class="pl-12 pr-4 font-semibold">Labor Card No</td>
            <td class="text-right pl-1 font-semibold">:</td>
            <td class="pl-2 w-[160px]" id="laborCardPreview">—</td>
          </tr>
          <tr>
            <td class="pr-4 font-semibold">Emirates ID</td>
            <td class="text-right pl-1 font-semibold">:</td>
            <td class="pl-2 w-[180px]" id="emiratesIdPreview">—</td>
            <td class="pl-12 pr-4 font-semibold">Position</td>
            <td class="text-right pl-1 font-semibold">:</td>
            <td class="pl-2 w-[160px]" id="positionPreview">—</td>
          </tr>
        </table>
      </div>
      <div class="font-bold mb-3 text-[15px]">
        
        Subject: Confirmation of Full and Final Settlement up to <span id="periodPreview">—</span>
        
      </div>
      <div class="mb-3">
        Dear Mr. <span id="employeeNameUpperPreview" class="font-bold">—</span>, 
        this letter is issued to confirm that your employment has been fully and finally settled up to the period ending <span id="periodPreview2">—</span>.
      </div>
      <div class="mb-3">
        You were offered an internal offer letter with a salary of AED <span id="offerSalaryPreview">—</span>, while your registered MOHRE labor contract stated a salary of AED <span id="mohreSalaryPreview">—</span>. This is to confirm that the salary, whether as per the offer letter or labor contract, has been paid and cleared in full from your date of joining until <span id="periodPreview3">—</span>, and there are no dues pending from the company side in any form — salary, cash, allowances, or any other employment-related benefit.
      </div>
      <div class="mb-2">You further confirm and acknowledge the following:</div>
      <ol class="list-decimal pl-6 mb-3 text-[15px]">
        <li>You have received your full salary and all benefits (if any) up to and including <span id="periodPreview4">—</span>.</li>
        <li>There are no pending financial dues from the employer.</li>
        <li>You shall not file or pursue any claim, complaint, or legal action with MOHRE or any UAE authority regarding salary, dues, or employment matters related to your service until <span id="periodPreview5">—</span>.</li>
        <li>This settlement is final, irrevocable, and made with full mutual understanding.</li>
        <li>You have signed this declaration voluntarily and of your own free will.</li>
      </ol>
      <div class="font-medium mb-2">Employee Declaration:</div>
      <div class="mb-3">
        I, <span class="font-bold uppercase" id="employeeNameUpperPreview2">—</span>, hereby confirm that I have received my full and final settlement up to 
        <span id="periodPreview6">—</span>, and I have no further claims or pending dues. I shall not raise any complaints or legal cases regarding my employment.
      </div>
      <div class="flex flex-row justify-between mt-8 mb-2">
        <div class="flex flex-col justify-end min-w-[230px]">
          <div class="font-medium mb-2">Authorised Signature</div>
          <div class="mt-6 mb-0 text-[15px]">Name: <span id="signNamePreview">—</span></div>
          <div class="mb-3 text-[15px]">Designation: <span id="signDesgPreview">—</span></div>
        </div>
        <div class="flex flex-col items-end justify-end min-w-[230px]">
          <div class="border-t border-slate-300 pt-1 text-sm text-right mt-2 mb-1">Employee Signature</div>
          <div class="mb-1 text-sm text-slate-500 text-right">Date: <span id="date2Preview">—</span></div>
        </div>
      </div>
    </div>
    <button type="button" id="downloadPdf" class="pl-2 no-print mt-6 px-4 py-2 rounded-none font-medium bg-green-600 text-white hover:bg-green-700 ring-1 ring-green-400 hover:ring-green-600" disabled>Download PDF</button>
  </div>
  <!-- Flatpickr JS -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    flatpickr("#date", {
      dateFormat: "d/m/Y",
      maxDate: "today",
      defaultDate: "today",
      allowInput: true,
    });
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const maxMonth = `${yyyy}-${mm}`;
    document.getElementById('period').setAttribute('max', maxMonth);
    document.getElementById('period').value = maxMonth;
    function formatMonthYear(value) {
      if (!value) return '';
      const [year, month] = value.split("-");
      const date = new Date(year, month - 1);
      return date.toLocaleString(undefined, { month: "long", year: "numeric" }).toUpperCase();
    }
    document.getElementById("emiratesId").addEventListener("input", function(e) {
      let val = e.target.value.replace(/[^0-9]/g, "");
      let formatted = '';
      if(val.length > 0) formatted += val.slice(0, 3);
      if(val.length > 3) formatted += '-' + val.slice(3, 7);
      if(val.length > 7) formatted += '-' + val.slice(7, 14);
      if(val.length > 14) formatted += '-' + val.slice(14, 15);
      e.target.value = formatted.slice(0, 18);
    });
    document.getElementById('generate').onclick = function() {
      document.getElementById('employeeNamePreview').innerText = document.getElementById('employeeName').value;
      document.getElementById('employeeNameUpperPreview').innerText = document.getElementById('employeeName').value.toUpperCase();
      document.getElementById('employeeNameUpperPreview2').innerText = document.getElementById('employeeName').value.toUpperCase();
      document.getElementById('emiratesIdPreview').innerText = document.getElementById('emiratesId').value;
      const dateVal = document.getElementById('date').value || "";
      document.getElementById('datePreview').innerText = dateVal;
      document.getElementById('date2Preview').innerText = dateVal;
      document.getElementById('laborCardPreview').innerText = document.getElementById('laborCard').value;
      document.getElementById('positionPreview').innerText = document.getElementById('position').value;
      const periodVal = document.getElementById('period').value;
      const periodFormatted = formatMonthYear(periodVal);
      document.getElementById('periodPreview').innerText = periodFormatted;
      document.getElementById('periodPreview2').innerText = periodFormatted;
      document.getElementById('periodPreview3').innerText = periodFormatted;
      document.getElementById('periodPreview4').innerText = periodFormatted;
      document.getElementById('periodPreview5').innerText = periodFormatted;
      document.getElementById('periodPreview6').innerText = periodFormatted;
      document.getElementById('offerSalaryPreview').innerText = document.getElementById('offerSalary').value;
      document.getElementById('mohreSalaryPreview').innerText = document.getElementById('mohreSalary').value;
      document.getElementById('signNamePreview').innerText = document.getElementById('signName').value;
      document.getElementById('signDesgPreview').innerText = document.getElementById('signDesg').value;
      document.getElementById('downloadPdf').disabled = false;
    };
    document.getElementById('downloadPdf').onclick = function() {
      const element = document.getElementById('letter');
      let employeeName = document.getElementById('employeeName').value.trim();
      employeeName = employeeName.replace(/\s+/g, '-').replace(/[^a-zA-Z0-9\-]/g, '');
      const filename = employeeName ? `${employeeName}-settlement.pdf` : "employee-settlement.pdf";
      const opt = {
        margin: [12,15,12,15],
        filename: filename,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true, letterRendering: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    };
  </script>
</body>
</html>



